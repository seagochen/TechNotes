
@[toc]

# 小波函数与逆函数，及其离散形式表达

由于小波变换作为一种可以将原始信号分解为不同频带的数学工具，而且在上一章中我们已经简要的介绍了它与傅里叶函数的异同，和一些其他特点，所以在这一章中我们再继续探讨一些关于小波在信号分解和合成方面的数学原理。

首先，还是我们的小波函数，它长下面这个样子：

$$W_a^bx(t)=\frac{1}{\sqrt{a}}\int_{-\infty}^{\infty}x(\tau)\psi\left(\frac{\tau-b}{a}\right)d\tau$$

其中，$\psi \left(\frac{\tau-b}{a}\right)$ 是小波函数，比如墨西哥帽小波，Haar小波等，这里的$a$ 和 $b$ 是尺度和平移参数，又或者你也能在某些教科书中见到这样的写法 $\psi(t)$ 。而 $x(\tau)$ 是原始信号。

对于上式，其对应的逆变换为：

$$x(t)=\frac{1}{C_\psi}\int_{0}^{\infty}\int_{-\infty}^{\infty}W_a^bx(t)\psi_{a,b}(t)dadb$$

其中，$\psi_{a,b}(t)=\frac{1}{\sqrt{a}}\psi\left(\frac{t-b}{a}\right)$，$C_\psi$是小波函数的常数。**这个公式表示说，执行连续小波函数的逆运算，其实等价于小波函数与所得系数的连续卷积，即可以简要的表达为：**

$$x(t) = \int_{-\infty}^{\infty} W(t - \tau) * \psi (\tau) \ d\tau$$

这里的小波函数$\psi(\tau)$是一个满足正交条件的函数，即：

$$\int_{-\infty}^{\infty}\psi(t)\psi(t-\tau)dt=\delta(\tau)$$

其中，$\delta(\tau)$是单位冲击函数。

所以，我们可以立即得到一个和上面相似的，但是更简单点的方法来描述这组公式，也就是小波的离散形式，即对于离散信号 $x[n]$，其小波公式为：

$$c_i[n] = \sum_{k} x[k] * h_{i}[n - k]$$

其中 $c_i[n]$ 为小波系数，$h_i[n]$ 为小波函数（Wavelet Function），$*$ 表示卷积运算。而相对的，如果我们获得了一组小波系数  $c_i[n]$，那么逆小波变换的公式为：

$$x[n] = \sum_{i=1}^{N} h_{i}[n] * c_{i}[n]$$

其中 $h_i[n]$ 为小波函数（Wavelet Function），$*$ 表示卷积运算。

# 常见小波核函数

## Haar 小波
Haar小波是最简单的小波，其公式为

$$h(t) = \begin{cases} 
1 & t \in [0, \frac{1}{2}] \\ 
-1 & t \in [\frac{1}{2}, 1] \\
0 & \text{otherwise} \end{cases}$$

Haar 小波是最简单的小波核函数，具有较低的计算复杂度。它可以用于简单的图像压缩和去噪。

## Daubechies 小波
Daubechies 小波是一类常用的小波核函数，其中最常用的是 $D4$ 小波，公式为：

$$h(t) = \frac{1 + \sqrt{3}}{4} (1 + t) e^{-\frac{t}{2}} u(t) - \frac{1 - \sqrt{3}}{4} (1 - t) e^{-\frac{t}{2}} u(-t)$$

其中 $u(t)$ 为单位函数。Daubechies 小波是一类常用的小波核函数，具有较好的时频分解性能。它常用于图像压缩、信号处理、医学图像处理等应用中。

## Symlets 小波
Symlets 小波是一类常用的小波核函数，其中最常用的是 $S8$ 小波，公式为：

$$h(t) = -\frac{1}{8} t^3 e^{-\frac{t}{2}} u(t) + \frac{1}{4} t e^{-\frac{t}{2}} u(-t)$$

Symlets 小波是一类常用的小波核函数，具有较高的计算效率。它常用于图像压缩、信号处理、音频处理等应用中。

## Coiflets 小波
Coiflets 小波是一类常用的小波核函数，其中最常用的是 $C6$ 小波，公式为：

$$h(t) = \frac{1 + \sqrt{6}}{32} t^5 e^{-\frac{t}{2}} u(t) - \frac{1 + \sqrt{6}}{8} t^3 e^{-\frac{t}{2}} u(-t) + \frac{1 - \sqrt{6}}{32} t e^{-\frac{t}{2}} u(t)$$

Coiflets 小波是一类常用的小波核函数，具有较高的时域精度和较低的频域精度。它常用于图像压缩、信号处理、医学图像处理等应用中。

## Marr 小波
$$h(t) = \frac{1}{\sqrt{2}} \left[ \frac{1}{\sqrt{2}} e^{-\frac{t}{2}} u(t) - \frac{1}{\sqrt{2}} e^{\frac{t}{2}} u(-t) \right]$$

其中 $u(t)$ 为单位函数。Marr wavelet 具有窄带频率响应，可以对图像进行高通滤波。它在图像增强中常用于去除噪声或提取图像的纹理信息。

# 小波函数的关键特性
我们不能无脑的使用小波去进行信号或图像处理，所以必须对小波的重要特性做一定的了解。一般说来，小波具备如下关键特性：

* 小波具有时频均衡的特性，即在时域和频域上的分解精度相似。
* 小波具有多阶平移不变的特性，即平移小波函数的位置，可以得到完全相同的分解结果。
* 小波具有稳定性的特性，即经过小波变换后的信号对于原信号的变化非常敏感。
* 小波具有稀疏性的特性，即大多数信号在小波变换后的系数都非常小，只有很少的系数具有较大的值。

在下一章节中，我们将看看一些具体的应用，和如何人工实现一个小波用于信号处理的。
